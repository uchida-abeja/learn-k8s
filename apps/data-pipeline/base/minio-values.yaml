# MinIO Official Helm Chart Values
# Official MinIO Chart: https://github.com/minio/minio/tree/master/helm/minio

# モード設定（standalone = シングルノード）
mode: standalone

# レプリカ数
replicas: 1

# 認証情報
# 注: これらの値はSealed Secretで管理されています（infrastructure/sealed-secrets/）
# Helmチャートの制限により、ここに値を記載する必要がありますが、
# 実際の認証はminio-credentials Secretが使用されます
rootUser: admin
rootPassword: password

# 既存のSecretを使用（Sealed Secretから生成）
existingSecret: minio-credentials

# 環境変数（Webhook Notification設定を永続化）
environment:
  MINIO_NOTIFY_WEBHOOK_ENABLE_PRIMARY: "on"
  MINIO_NOTIFY_WEBHOOK_ENDPOINT_PRIMARY: "http://webhook-receiver:5000/minio-event"
  MINIO_NOTIFY_WEBHOOK_QUEUE_LIMIT_PRIMARY: "10"

# ストレージ設定
persistence:
  enabled: false  # 開発環境ではemptyDirを使用
  # enabled: true  # 本番環境ではPVCを使用
  # size: 10Gi
  # storageClass: "standard"

# リソース制限
resources:
  requests:
    memory: 256Mi
    cpu: 100m

# Service設定
service:
  type: ClusterIP
  port: 9000

# Console設定（MinIO管理画面）
consoleService:
  type: ClusterIP
  port: 9001

# デフォルトバケットの作成
buckets:
  - name: raw-data
    policy: none
    purge: false
  - name: processed-data
    policy: none
    purge: false

# ArgoCD経由のデプロイではHelm hooksを無効化
# helm.sh/hookアノテーションをダミー値で上書き
postJob:
  annotations:
    "helm.sh/hook": "null"
    "helm.sh/hook-delete-policy": "null"

# イメージ設定（公式MinIOイメージ）
image:
  repository: quay.io/minio/minio
  tag: RELEASE.2024-12-18T13-15-44Z
  pullPolicy: IfNotPresent
